{% extends "base.html" %}

{% block main %}
    

    <style>
    /* Simple inline styling for clarity */
    .inline-form {display: none;}
    .inline-form.visible { display: inline-block; }
    .title-text { margin-right: 0.75rem; }

    .task-item { display: flex; align-items: center; gap: 1rem; margin: 0.5rem 0; }
    .delete-btn { background: #c62828; color: #fff; border: none; padding: 0.35rem 0.6rem; cursor: pointer; }
    .delete-btn:hover { background: #b71c1c; }
    .flash { background: #e8f5e9; border-left: 4px solid #43a047; padding: 0.5rem; margin-bottom: 0.75rem; }
    .btn-primary { color: #ff3;}
    .btn {background: #c62828; border: none; padding: 0.35rem 0.6rem; cursor: pointer;}
    .btn-danger { color: #aa2}
    </style>

    {% if tasks %}
    <h1>My current wish list</h1>
    {% else %}
    <h1>No wishes sent yet!</h1>
    {% endif %}
        
    <ul>
        {% for task in tasks %}
            <li class="task-item">
            <form class="inline-form" action="{{ url_for('edit_task', task_id=task.id) }}" method="POST">
            <input type="text" name="title" value="{{ task.title}}">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <button type="submit" class="btn btn-primary">Save</button>
            <button type="button" class="btn cancel-btn">Cancel</button>
            </form>
            <h3><span class="title-text">{{ task.title }}</span></h3> created on {{ task.date }}
            
            <form action="{{ url_for('delete_task', task_id=task.id) }}" method="POST" onsubmit="return confirm('Delete this wish permanently?')">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <button type="submit" class="delete-btn">Delete</button>
            </form>
            
            <button class="btn btn-primary edit-btn" type="button">Edit</button>
            
            

            </li>
        {% endfor %}
    </ul>
    <script>
        document.querySelectorAll('.edit-btn').forEach(btn => {
          btn.addEventListener('click', e => {
            const li = e.target.closest('li');
            const form = li.querySelector('.inline-form');
            const titleSpan = li.querySelector('.title-text');
        
            form.classList.add('visible');      // show form
            titleSpan.style.display = 'none';   // hide static title
          });
        });
        
        document.querySelectorAll('.cancel-btn').forEach(btn => {
          btn.addEventListener('click', e => {
            const li = e.target.closest('li');
            const form = li.querySelector('.inline-form');
            const titleSpan = li.querySelector('.title-text');
        
            form.classList.remove('visible');   
            titleSpan.style.display = '';
          });
        });
    </script>
{% endblock %}
